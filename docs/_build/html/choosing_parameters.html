

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Choosing parameters &mdash; drep 3.0.0 documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic|Roboto+Slab:400,700|Inconsolata:400,700&subset=latin,cyrillic' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="drep 3.0.0 documentation" href="index.html"/>
        <link rel="next" title="Advanced Use" href="advanced_use.html"/>
        <link rel="prev" title="Module Descriptions" href="module_descriptions.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        
          <a href="index.html" class="fa fa-home"> drep</a>
        
        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="overview.html#genome-de-replication">Genome de-replication</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="installation.html#dependencies">Dependencies</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#testing">Testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#pyenv">pyenv</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="quick_start.html">Quick Start</a><ul>
<li class="toctree-l2"><a class="reference internal" href="quick_start.html#de-replication">De-replication</a></li>
<li class="toctree-l2"><a class="reference internal" href="quick_start.html#genome-comparison">Genome comparison</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="interpreting_output.html">Interpreting Output</a><ul>
<li class="toctree-l2"><a class="reference internal" href="interpreting_output.html#figures">Figures</a></li>
<li class="toctree-l2"><a class="reference internal" href="interpreting_output.html#warnings">Warnings</a></li>
<li class="toctree-l2"><a class="reference internal" href="interpreting_output.html#raw-data">Raw data</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="module_descriptions.html">Module Descriptions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="module_descriptions.html#work-directory">Work Directory</a></li>
<li class="toctree-l2"><a class="reference internal" href="module_descriptions.html#filter">Filter</a></li>
<li class="toctree-l2"><a class="reference internal" href="module_descriptions.html#cluster">Cluster</a></li>
<li class="toctree-l2"><a class="reference internal" href="module_descriptions.html#choose">Choose</a></li>
<li class="toctree-l2"><a class="reference internal" href="module_descriptions.html#analyze">Analyze</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="">Choosing parameters</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#what-defines-genomes-as-being-same">What defines genomes as being &#8220;same&#8221;?</a></li>
<li class="toctree-l2"><a class="reference internal" href="#what-is-the-minimum-genome-completeness-allowed-in-analysis">What is the minimum genome completeness allowed in analysis?</a></li>
<li class="toctree-l2"><a class="reference internal" href="#the-rest-of-the-parameters">The rest of the parameters</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="advanced_use.html">Advanced Use</a></li>
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">drep</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>Choosing parameters</li>
      <li class="wy-breadcrumbs-aside">
        
          <a href="_sources/choosing_parameters.txt" rel="nofollow"> View page source</a>
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">
            
  <div class="section" id="choosing-parameters">
<h1>Choosing parameters<a class="headerlink" href="#choosing-parameters" title="Permalink to this headline">¶</a></h1>
<p>The values used during de-replication (and simply genome comparison) are critical to understanding what exactly the program is doing to your genome set.</p>
<p><em>For a more general description of routine parameters, see :doc:`module_descriptions`</em></p>
<p>There are two critical high-level decisions you must make before running dRep to de-replicate a genome set:</p>
<p><em>1. How similar do genomes need to be for them to be the “same”?</em></p>
<p><em>2. What is the minimum genome completeness allowed in analysis?</em></p>
<div class="section" id="what-defines-genomes-as-being-same">
<h2>What defines genomes as being &#8220;same&#8221;?<a class="headerlink" href="#what-defines-genomes-as-being-same" title="Permalink to this headline">¶</a></h2>
<p>There is no standard definition of the average nucleotide identity (ANI) shared between two genomes that are the &#8220;same&#8221;. How dRep determines this is primarily impacted by the <strong>secondary clustering algorithm</strong>, the <strong>minimum secondary ANI</strong>, and the <strong>minimum aligned fraction</strong>.</p>
<p>The <a href="#id1"><span class="problematic" id="id2">**</span></a>secondary clustering algorithm* is the program that will calculate the accurate Average Nucleotide Identity (ANI) between genomes. The current options supported by dRep are ANIm (link to publication) and gANI (link to publication). ANIm aligns whole genome fragments and calculates the nucleotide identity of aligned regions, and gANI aligns only the ORFs called by prodigal. Neither of these algorithms are perfect, especially in repeat-prone genomes, as regions of the genome which are not homologous can align to each other. In fact, when a genome is compared to itself, ANIm often reports values &lt;100% for this very reason. gANI is better about this, but there still exists an undefined &#8220;limit of detection&#8221;. See Figure 1A of the publication for more.</p>
<p>The <strong>minimum secondary ANI</strong> is the minimum ANI between genomes from them to be considered the &#8220;same&#8221;. For context, genomes of the same species typically are ~96.5% ANI (reference). The default value is 99%. Preliminary testing suggests that with gANI, taking this up to 99.9% is probably safe, but higher than that is beyond the limit of detection. For ANIm, you really can&#8217;t go above 99%, as a comparison of a genome to itself can sometime get that low.</p>
<p><em>Keep in mind that in all cases you are collapsing closely related, but probably not identical, strains / genomes. This is simply the nature of the beast. If desired, you can compare the strains by mapping the original reads back to the de-replicated genome to visualize the strain cloud (link to Meren&#8217;s blog post), or by comparing genomes in a secondary cluster using other methods (like Mauve)</em></p>
<p>The <strong>minimum aligned fraction</strong> is the minimum amount that genomes must overlap to make the reported ANI value &#8220;count&#8221;. This value is reported as part of the ANIm/gANI algorithms. Imagine a scenario where two genomes of a separate phyla share a single transposon. When the ANIm/gANI algorithm is run, the transposon is probably the only part of the genome that aligns, and the alignment will have 100% ANI. This will result in a reported ANI of 100%, and reported <strong>aligned fraction</strong> of ~0.1%. The <strong>minimum aligned fraction</strong> is to handle the above scenario- anything with less than this amount of genome alignment will have the ANI changed to 0. Default value is 10%.</p>
</div>
<div class="section" id="what-is-the-minimum-genome-completeness-allowed-in-analysis">
<h2>What is the minimum genome completeness allowed in analysis?<a class="headerlink" href="#what-is-the-minimum-genome-completeness-allowed-in-analysis" title="Permalink to this headline">¶</a></h2>
<p>This decision is much more complicated than the previous. Essentially, there exists a trade-off between computational efficiency and the minimum genome completeness.
The reason this trade-off exists is due to the fact that <strong>Mash ANI</strong> is artificially decreased with increasing genome incompleteness.</p>
<img alt="_images/subsettingv0.png" src="_images/subsettingv0.png" />
<p>Remember- genomes are first divided into primary clusters using Mash, and then each primary cluster is divided into secondary clusters of the &#8220;same&#8221; genomes based on the users definition of “same” (see above). <em>Therefore, genomes which fit the definition of “same” (as described above) must end up in the same primary cluster</em>. As more incomplete genomes have lower Mash values (even if the genomes are truly identical), you must decrease the <strong>primary cluster threshold</strong> if you allow in more incomplete genomes, which will result in larger primary clusters, which will result in more required secondary comparisons (slow), which will result in a longer run-time. Still with me?</p>
<p>For example, say I set the minimum genome completeness to 50%. If I take an <em>E. coli</em> genome, subset it 50% 2 times, and compare those 2 subset genomes together, Mash will report an ANI of 92%. Therefore, the primary cluster threshold must be at least 92%, otherwise the two genomes could end up in different primary clusters, and thus would have have the secondary algorithm run between them, and thus would not be de-replicated.</p>
<p>You may be wondering why not just set the primary cluster threshold super low? This would result in more genomes being included in each primary cluster, and thus more secondary comparisons (which are slow), and thus a higher run-time.</p>
<p>Some general guidelines for picking genome completeness thresholds:</p>
<ul class="simple">
<li>Going below 50% completeness is not recommended. The resulting genome will be very crappy anyways, and even the secondary algorithms break-down at this point.</li>
<li>Lowering the secondary ANI should result in a consummate lowering in MASH ANI. This is because you want Mash to group non-similar <em>and</em> incomplete genomes).</li>
<li>To make sure clusters are not being split unnecessarily, you can run the warnings at the end. See <a class="reference internal" href="module_descriptions.html"><em>Module Descriptions</em></a> for info</li>
</ul>
</div>
<div class="section" id="the-rest-of-the-parameters">
<h2>The rest of the parameters<a class="headerlink" href="#the-rest-of-the-parameters" title="Permalink to this headline">¶</a></h2>
<p>The most important and confusing parameters are described above. For information on the other parameters, see <a class="reference internal" href="module_descriptions.html"><em>Module Descriptions</em></a></p>
</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="advanced_use.html" class="btn btn-neutral float-right" title="Advanced Use">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="module_descriptions.html" class="btn btn-neutral" title="Module Descriptions"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Matt Olm.
    </p>
  </div>

  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
  
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'3.0.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>