

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Choosing parameters &mdash; drep 3.0.0 documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic|Roboto+Slab:400,700|Inconsolata:400,700&subset=latin,cyrillic' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="drep 3.0.0 documentation" href="index.html"/>
        <link rel="next" title="Advanced Use" href="advanced_use.html"/>
        <link rel="prev" title="Module Descriptions" href="module_descriptions.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        
          <a href="index.html" class="fa fa-home"> drep</a>
        
        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="overview.html#genome-de-replication">Genome de-replication</a></li>
<li class="toctree-l2"><a class="reference internal" href="overview.html#genome-comparison">Genome comparison</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="installation.html#using-pip">Using pip</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#dependencies">Dependencies</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#testing">Testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#pyenv">pyenv</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="quick_start.html">Quick Start</a><ul>
<li class="toctree-l2"><a class="reference internal" href="quick_start.html#de-replication">De-replication</a></li>
<li class="toctree-l2"><a class="reference internal" href="quick_start.html#genome-comparison">Genome comparison</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="interpreting_output.html">Interpreting Output</a><ul>
<li class="toctree-l2"><a class="reference internal" href="interpreting_output.html#figures">Figures</a></li>
<li class="toctree-l2"><a class="reference internal" href="interpreting_output.html#warnings">Warnings</a></li>
<li class="toctree-l2"><a class="reference internal" href="interpreting_output.html#other-data">Other data</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="module_descriptions.html">Module Descriptions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="module_descriptions.html#work-directory">Work Directory</a></li>
<li class="toctree-l2"><a class="reference internal" href="module_descriptions.html#filter">Filter</a></li>
<li class="toctree-l2"><a class="reference internal" href="module_descriptions.html#cluster">Cluster</a></li>
<li class="toctree-l2"><a class="reference internal" href="module_descriptions.html#choose">Choose</a></li>
<li class="toctree-l2"><a class="reference internal" href="module_descriptions.html#analyze">Analyze</a></li>
<li class="toctree-l2"><a class="reference internal" href="module_descriptions.html#evaluate">Evaluate</a></li>
<li class="toctree-l2"><a class="reference internal" href="module_descriptions.html#other">Other</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="">Choosing parameters</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#what-defines-genomes-as-being-same">What defines genomes as being &#8220;same&#8221;?</a></li>
<li class="toctree-l2"><a class="reference internal" href="#what-is-the-minimum-genome-completeness-allowed-in-analysis">What is the minimum genome completeness allowed in analysis?</a></li>
<li class="toctree-l2"><a class="reference internal" href="#the-rest">The Rest</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="advanced_use.html">Advanced Use</a><ul>
<li class="toctree-l2"><a class="reference internal" href="advanced_use.html#accessing-internal-information">Accessing Internal Information</a></li>
<li class="toctree-l2"><a class="reference internal" href="advanced_use.html#caching">Caching</a></li>
<li class="toctree-l2"><a class="reference internal" href="advanced_use.html#api">API</a></li>
</ul>
</li>
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">drep</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>Choosing parameters</li>
      <li class="wy-breadcrumbs-aside">
        
          <a href="_sources/choosing_parameters.txt" rel="nofollow"> View page source</a>
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">
            
  <div class="section" id="choosing-parameters">
<h1>Choosing parameters<a class="headerlink" href="#choosing-parameters" title="Permalink to this headline">¶</a></h1>
<p>The values used during de-replication and genome comparison are critical to understanding what the program is actually doing to your genome set.</p>
<p>There are two critical high-level decisions you must make before running dRep to de-replicate a genome set:</p>
<p><strong>1. How similar do genomes need to be for them to be considered the “same”?</strong></p>
<p><strong>2. What is the minimum genome completeness allowed in analysis?</strong></p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="module_descriptions.html"><em>Module Descriptions</em></a></dt>
<dd>For more general descriptions of routine parameters</dd>
</dl>
</div>
<div class="section" id="what-defines-genomes-as-being-same">
<h2>What defines genomes as being &#8220;same&#8221;?<a class="headerlink" href="#what-defines-genomes-as-being-same" title="Permalink to this headline">¶</a></h2>
<p>There is no standard definition of the average nucleotide identity (ANI) shared between two genomes that are the &#8220;same&#8221;. This is a decision that the user must make on their own, depending on their own specific application. The ANI is determined by the <strong>secondary clustering algorithm</strong>, the <strong>minimum secondary ANI</strong> is the minimum ANI between genomes to be considered the &#8220;same&#8221;, and the <strong>minimum aligned fraction</strong> is the minimum amount of genome overlap to believe the reported ANI value.</p>
<div class="section" id="secondary-clustering-algorithm">
<h3>Secondary clustering algorithm<a class="headerlink" href="#secondary-clustering-algorithm" title="Permalink to this headline">¶</a></h3>
<p>The <strong>secondary clustering algorithm</strong> is the program that will calculate the accurate Average Nucleotide Identity (ANI) between genomes. The current options supported by dRep are ANIm (<a class="reference external" href="https://www.ncbi.nlm.nih.gov/pubmed/19855009">Richter 2009</a>) and gANI (<a class="reference external" href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4538840/">Varghese 2015</a>).</p>
<ul class="simple">
<li><strong>ANIm</strong> aligns whole genome fragments and calculates the nucleotide identity of aligned regions</li>
<li><strong>gANI</strong> aligns ORFs called by prodigal and calculates the nucleotide identity of aligned ORFs</li>
</ul>
<p>Neither of these algorithms are perfect, especially in repeat-prone genomes. Regions of the genome which are not homologous can align to each other and artificially decrease ANI. In fact, when a genome is compared to itself, ANIm often reports values &lt;100% for this reason. gANI is better about this, but seems to be more sensitive to genome subsetting.</p>
</div>
<div class="section" id="minimum-secondary-ani">
<h3>Minimum secondary ANI<a class="headerlink" href="#minimum-secondary-ani" title="Permalink to this headline">¶</a></h3>
<p>The <strong>minimum secondary ANI</strong> is the minimum ANI between genomes for them to be considered the &#8220;same&#8221;. For context, genomes of the same species typically have &gt;=96.5% gANI (<a class="reference external" href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4538840/">Varghese 2015</a>).</p>
<p>The default value in dRep is 99%. Preliminary testing suggests that with gANI taking this up to 99.9% is probably safe, but higher than that is beyond the limit of detection. For ANIm you really can&#8217;t go above 99%, as a comparison of a genome to itself can sometimes get that low. gANI is more thrown by genome incompleteness; ANIm is more thrown by repeat-regions.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Keep in mind that in all cases you are collapsing closely related, but probably not identical, strains / genomes. This is simply the nature of the beast. If desired, you can compare the strains by mapping the original reads back to the de-replicated genome to visualize the strain cloud (<a class="reference external" href="http://www.nature.com/ismej/journal/v10/n7/full/ismej2015241a.html">Bendall 2016</a>, <a class="reference external" href="http://merenlab.org/2015/07/20/analyzing-variability/">blog post</a>), or by comparing genomes within a secondary cluster using other methods (like <a class="reference external" href="http://darlinglab.org/mauve/mauve.html">Mauve</a>)</p>
</div>
</div>
<div class="section" id="minimum-aligned-fraction">
<h3>Minimum aligned fraction<a class="headerlink" href="#minimum-aligned-fraction" title="Permalink to this headline">¶</a></h3>
<p>The <strong>minimum aligned fraction</strong> is the minimum amount that genomes must overlap to make the reported ANI value &#8220;count&#8221;. This value is reported as part of the ANIm/gANI algorithms.</p>
<p>Imagine a scenario where two genomes of a separate phyla share a single identical transposon. When the ANIm/gANI algorithm is run, the transposon is probably the only part of the genomes that aligns, and the alignment will have 100% ANI. This will result in a reported ANI of 100%, and reported <strong>aligned fraction</strong> of ~0.1%. The <strong>minimum aligned fraction</strong> is to handle the above scenario- anything with less than the minimum aligned fraction of genome alignment will have the ANI changed to 0. Default value is 10%.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">It has been suggested that a minimum aligned fraction of 60% should be applied to species-level taxonomic definitions (<a class="reference external" href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4538840/">Varghese 2015</a>). However, this is probably too stringent when incomplete genomes are being used (as is the case with genome de-replication)</p>
</div>
</div>
</div>
<div class="section" id="what-is-the-minimum-genome-completeness-allowed-in-analysis">
<h2>What is the minimum genome completeness allowed in analysis?<a class="headerlink" href="#what-is-the-minimum-genome-completeness-allowed-in-analysis" title="Permalink to this headline">¶</a></h2>
<p>This decision is much more complicated than the previous. Essentially, there exists a trade-off between computational efficiency and the minimum genome completeness.</p>
<div class="figure align-center" id="id3">
<a class="reference internal image-reference" href="_images/FigureB.png"><img alt="_images/FigureB.png" src="_images/FigureB.png" style="width: 400px;" /></a>
<p class="caption"><span class="caption-text"><strong>Figure A</strong>: Five genomes are subset to fractions ranging from 10% - 100%, and fractions from the same genome are compared. The x-axis is the minimum genome completeness allowed. The looser this value is, the wider the range of aligned fractions.</span></p>
</div>
<p>As shown in the above Figure A, the lower the limit of genome completeness, the lower possible aligned fraction of two genomes. This makes sense- if you randomly take 20% of a genome, and than do the same thing again, when you compare these two random 20% subsets you would not expect very much of them to align. This &#8220;aligned fraction&#8221; really becomes a problem when you consider it&#8217;s effect on Mash:</p>
<div class="figure align-center" id="id4">
<a class="reference internal image-reference" href="_images/subsettingv0.png"><img alt="_images/subsettingv0.png" src="_images/subsettingv0.png" style="width: 400px;" /></a>
<p class="caption"><span class="caption-text"><strong>Figure B</strong>: An identical <em>E. coli</em> genome is subset to fractions ranging from 10% - 100% and fractions are compared. When lower amounts of the genome align (due to incompleteness), Mash ANI is severely impacted</span></p>
</div>
<p>As shown in the above Figure B, the lower the aligned fraction, the lower the reported Mash ANI <strong>for identical genomes</strong>.</p>
<p>Remember- genomes are first divided into primary clusters using Mash, and then each primary cluster is divided into secondary clusters of the &#8220;same&#8221; genomes. Therefore, genomes which fit the definition of “same” <strong>must</strong> end up in the same primary cluster, or the problem will never realize they&#8217;re the same. As more incomplete genomes have lower Mash values (even if the genomes are truly identical; see <strong>Figure B</strong>), the more incomplete of genomes you allow into your genome list, the more you must decrease the <strong>primary cluster threshold</strong>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Having a lower <strong>primary cluster threshold</strong> which will result in larger primary clusters, which will result in more required secondary comparisons. This will result in a longer run-time.</p>
</div>
<p>Still with me?</p>
<p>For example, say I set the minimum genome completeness to 50%. If I take an <em>E. coli</em> genome, subset it 50% 2 times, and compare those 2 subset genomes together, Mash will report an ANI of 96%. Therefore, the primary cluster threshold must be at least 96%, otherwise the two genomes could end up in different primary clusters, and thus would never have have the secondary algorithm run between them, and thus would not be de-replicated.</p>
<p>You don&#8217;t want to set the primary cluster threshold super low, however, as this would result in more genomes being included in each primary cluster, and thus more secondary comparisons (which are slow), and thus a higher run-time.</p>
<p>Putting this altogether gives us a figure with the lowest reported ANI of identical genomes being subset to different fractions. This figure only takes into account 5 different genomes, but gives a rough idea of the limits.</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="_images/minANI.png"><img alt="_images/minANI.png" src="_images/minANI.png" style="width: 400px;" /></a>
</div>
<p>A final piece to consider is that when running dRep for real, the user don&#8217;t actually know how incomplete their genomes are. They have to rely on metrics like single copy gene inventories to tell them. This is the reason phage and plasmids are not currently supported by dRep- there is no way of knowing how complete they are, and thus no way of filtering out the bins that are too incomplete. In general though, checkM is pretty good at accessing genome completeness:</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="_images/checkM.png"><img alt="_images/checkM.png" src="_images/checkM.png" style="width: 400px;" /></a>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Some general guidelines for picking genome completeness thresholds:</p>
<ul class="last simple">
<li>Going below 50% completeness is not recommended. The resulting genomes will be very crappy anyways, and even the secondary algorithms break-down at this point.</li>
<li>Lowering the secondary ANI should result in a consummate lowering in MASH ANI. This is because you want Mash to group non-similar <em>and</em> incomplete genomes.</li>
<li>To make sure clusters are not being split unnecessarily, you can run the warnings at the end. See <a class="reference internal" href="module_descriptions.html"><em>Module Descriptions</em></a> for info</li>
</ul>
</div>
</div>
<div class="section" id="the-rest">
<h2>The Rest<a class="headerlink" href="#the-rest" title="Permalink to this headline">¶</a></h2>
<p>The most important and confusing parameters are described above. For information on the other parameters, see <a class="reference internal" href="module_descriptions.html"><em>Module Descriptions</em></a></p>
</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="advanced_use.html" class="btn btn-neutral float-right" title="Advanced Use">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="module_descriptions.html" class="btn btn-neutral" title="Module Descriptions"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Matt Olm.
    </p>
  </div>

  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
  
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'3.0.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>