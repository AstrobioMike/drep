

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Advanced Use &mdash; drep 3.0.0 documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic|Roboto+Slab:400,700|Inconsolata:400,700&subset=latin,cyrillic' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="drep 3.0.0 documentation" href="index.html"/>
        <link rel="prev" title="Choosing parameters" href="choosing_parameters.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        
          <a href="index.html" class="fa fa-home"> drep</a>
        
        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="overview.html#genome-de-replication">Genome de-replication</a></li>
<li class="toctree-l2"><a class="reference internal" href="overview.html#genome-comparison">Genome comparison</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="installation.html#using-pip">Using pip</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#dependencies">Dependencies</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#testing">Testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#pyenv">pyenv</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="quick_start.html">Quick Start</a><ul>
<li class="toctree-l2"><a class="reference internal" href="quick_start.html#de-replication">De-replication</a></li>
<li class="toctree-l2"><a class="reference internal" href="quick_start.html#genome-comparison">Genome comparison</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="interpreting_output.html">Interpreting Output</a><ul>
<li class="toctree-l2"><a class="reference internal" href="interpreting_output.html#figures">Figures</a></li>
<li class="toctree-l2"><a class="reference internal" href="interpreting_output.html#warnings">Warnings</a></li>
<li class="toctree-l2"><a class="reference internal" href="interpreting_output.html#other-data">Other data</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="module_descriptions.html">Module Descriptions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="module_descriptions.html#work-directory">Work Directory</a></li>
<li class="toctree-l2"><a class="reference internal" href="module_descriptions.html#filter">Filter</a></li>
<li class="toctree-l2"><a class="reference internal" href="module_descriptions.html#cluster">Cluster</a></li>
<li class="toctree-l2"><a class="reference internal" href="module_descriptions.html#choose">Choose</a></li>
<li class="toctree-l2"><a class="reference internal" href="module_descriptions.html#analyze">Analyze</a></li>
<li class="toctree-l2"><a class="reference internal" href="module_descriptions.html#evaluate">Evaluate</a></li>
<li class="toctree-l2"><a class="reference internal" href="module_descriptions.html#other">Other</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="choosing_parameters.html">Choosing parameters</a><ul>
<li class="toctree-l2"><a class="reference internal" href="choosing_parameters.html#what-defines-genomes-as-being-same">What defines genomes as being &#8220;same&#8221;?</a></li>
<li class="toctree-l2"><a class="reference internal" href="choosing_parameters.html#what-is-the-minimum-genome-completeness-allowed-in-analysis">What is the minimum genome completeness allowed in analysis?</a></li>
<li class="toctree-l2"><a class="reference internal" href="choosing_parameters.html#the-rest">The Rest</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="">Advanced Use</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#accessing-internal-information">Accessing Internal Information</a></li>
<li class="toctree-l2"><a class="reference internal" href="#caching">Caching</a></li>
<li class="toctree-l2"><a class="reference internal" href="#api">API</a></li>
</ul>
</li>
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">drep</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>Advanced Use</li>
      <li class="wy-breadcrumbs-aside">
        
          <a href="_sources/advanced_use.txt" rel="nofollow"> View page source</a>
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">
            
  <div class="section" id="advanced-use">
<h1>Advanced Use<a class="headerlink" href="#advanced-use" title="Permalink to this headline">¶</a></h1>
<div class="section" id="accessing-internal-information">
<h2>Accessing Internal Information<a class="headerlink" href="#accessing-internal-information" title="Permalink to this headline">¶</a></h2>
<p>All of internal information is stored in the work directory</p>
<div class="section" id="work-directory-file-tree">
<h3>work directory file-tree<a class="headerlink" href="#work-directory-file-tree" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python"><div class="highlight"><pre>workDirectory
./data
...../checkM/
...../Clustering_files/
...../gANI_files/
...../MASH_files/
...../ANIn_files/
...../prodigal/
./data_tables
...../Bdb.csv  # Sequence locations and filenames
...../Cdb.csv  # Genomes and cluster designations
...../Chdb.csv # CheckM results for Bdb
...../Mdb.csv  # Raw results of MASH comparisons
...../Ndb.csv  # Raw results of ANIn comparisons
...../Sdb.csv  # Scoring information
...../Wdb.csv  # Winning genomes
...../Widb.csv # Winning genomes&#39; checkM information
./dereplicated_genomes
./figures
./log
...../cluster_arguments.json
...../logger.log
...../warnings.txt
</pre></div>
</div>
</div>
<div class="section" id="data-tables">
<h3>Data Tables<a class="headerlink" href="#data-tables" title="Permalink to this headline">¶</a></h3>
<p>Within the <code class="docutils literal"><span class="pre">data_tables</span></code> folder is where organized data lives. It&#8217;s very easy to access this information, as it&#8217;s all stored in .csv files.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If you code in Python, I cannot recommend <a class="reference external" href="http://pandas.pydata.org/">pandas</a> enough for data-frame reading and manipulation. It&#8217;s how all data is manipulated behind the scenes in dRep. See the API section below for easy access to these dataframes</p>
</div>
<dl class="docutils">
<dt>Bdb</dt>
<dd>Genome input locations, filenames, and lengths</dd>
<dt>Cdb</dt>
<dd>Primary cluster, Secondary cluster, and information on clustering method for each genome</dd>
<dt>Chdb</dt>
<dd>CheckM results for all genomes</dd>
<dt>Mdb</dt>
<dd>Pair-wise Mash comparison results</dd>
<dt>Ndb</dt>
<dd>Secondary comparison results</dd>
<dt>Sdb</dt>
<dd>The score of each genome</dd>
<dt>Wdb</dt>
<dd>The cluster and score of de-replicated genomes</dd>
<dt>Widb</dt>
<dd>Useful checkM information on de-replicated genomes</dd>
</dl>
</div>
<div class="section" id="clustering-files">
<h3>Clustering files<a class="headerlink" href="#clustering-files" title="Permalink to this headline">¶</a></h3>
<p>These pickle files store information on both primary and secondary clusters. Loading the first value gives you the linkage, loading the second value gives you the db that was used to make the linkage, loading the third value give you a dictionary of the arguments that were used to make the linkage.</p>
<p>For example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">pickle</span><span class="p">,</span> <span class="s">&#39;rb&#39;</span><span class="p">)</span>
<span class="n">linkage</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="n">db</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="n">arguments</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="raw-data">
<h3>Raw data<a class="headerlink" href="#raw-data" title="Permalink to this headline">¶</a></h3>
<p>Refer to the above file structure to find the rest of the raw data. The data is kept from all program runs, so you can find the raw ANIm/gANI files, Mash sketches, prodigal gene predictions, centrifuge raw output, ect.</p>
</div>
</div>
<div class="section" id="caching">
<h2>Caching<a class="headerlink" href="#caching" title="Permalink to this headline">¶</a></h2>
<p>The reason that dRep stores all of the raw information that it does is so that if future operations require the same file, it can just load the file that&#8217;s already there instead of making it again. This goes for prodigal gene predictions, checkM, centrifuge, all ANI algorithms, ect. The data-frame that uses the information <strong>will</strong> be remade, but the information itself will not.</p>
<p>The reason I mention this is because if you would like to run another dRep operation that&#8217;s similar to one you&#8217;ve already run, you can use the results of the last run to speed up the second run.</p>
<p>For example, say you&#8217;ve already run the dereplicate_wf using gANI and want to run the same thing but with ANIm to compare. You can make a copy of the gANI work directory, and then run the dereplicate_wf on the copy specifying the new secondary algorithm. It will have to run all of the ANIm comparisons, but will <strong>not</strong> re-run checkM, prodigal, centrifuge, ect., as the data will already be cached in the work directory.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Be warned, this is somewhat buggy and can easily get out of hand. While it does save time, sometimes it&#8217;s just best to re-run the whole thing again with a clean start</p>
</div>
</div>
<div class="section" id="api">
<h2>API<a class="headerlink" href="#api" title="Permalink to this headline">¶</a></h2>
<p>This is no formal API for dRep, but of course you can read through the source-code and import any function that you&#8217;d like. The one class that is particularly helpful, however, is the WorkDirectory. By loading the results of your dRep run as a WorkDirectory object, you have direct access to all of the data-frames.</p>
<p>For example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">drep.WorkDirectory</span> <span class="kn">import</span> <span class="n">WorkDirectory</span>

<span class="n">wd</span> <span class="o">=</span> <span class="n">WorkDirectory</span><span class="p">(</span><span class="s">&#39;path/to/workdirectory&#39;</span><span class="p">)</span>
<span class="n">Mdb</span> <span class="o">=</span> <span class="n">wd</span><span class="o">.</span><span class="n">get_db</span><span class="p">(</span><span class="s">&#39;Mdb&#39;</span><span class="p">)</span>
<span class="n">Cdb</span> <span class="o">=</span> <span class="n">wd</span><span class="o">.</span><span class="n">get_db</span><span class="p">(</span><span class="s">&#39;Cdb&#39;</span><span class="p">)</span>
<span class="o">...</span>
</pre></div>
</div>
<p>This will work for all datatables</p>
</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="choosing_parameters.html" class="btn btn-neutral" title="Choosing parameters"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Matt Olm.
    </p>
  </div>

  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
  
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'3.0.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>